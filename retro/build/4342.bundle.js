(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[4342],{64342:(e,t,s)=>{"use strict";s.r(t),s.d(t,{CodeEditor:()=>c,CodeEditorWrapper:()=>V,IEditorMimeTypeService:()=>N,IEditorServices:()=>E,JSONEditor:()=>C});var i=s(63599),n=s(58137),a=s(98669),o=s(66065),h=s(1941),r=s(18718);class d{constructor(e=""){this._text="",this._isDisposed=!1,this._changed=new n.Signal(this),this._text=e}get type(){return"String"}get changed(){return this._changed}set text(e){e.length===this._text.length&&e===this._text||(this._text=e,this._changed.emit({type:"set",start:0,end:e.length,value:e}))}get text(){return this._text}insert(e,t){this._text=this._text.slice(0,e)+t+this._text.slice(e),this._changed.emit({type:"insert",start:e,end:e+t.length,value:t})}remove(e,t){const s=this._text.slice(e,t);this._text=this._text.slice(0,e)+this._text.slice(t),this._changed.emit({type:"remove",start:e,end:t,value:s})}clear(){this.text=""}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,n.Signal.clearData(this),this.clear())}}var l,c,u=s(79028);!function(e){e.itemCmp=function(e,t){return e===t}}(l||(l={}));class _ extends class{constructor(e={}){this._array=[],this._isDisposed=!1,this._changed=new n.Signal(this),void 0!==e.values&&(0,u.each)(e.values,(e=>{this._array.push(e)})),this._itemCmp=e.itemCmp||l.itemCmp}get type(){return"List"}get changed(){return this._changed}get length(){return this._array.length}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,n.Signal.clearData(this),this.clear())}iter(){return new u.ArrayIterator(this._array)}get(e){return this._array[e]}set(e,t){const s=this._array[e];if(void 0===t)throw new Error("Cannot set an undefined item");(0,this._itemCmp)(s,t)||(this._array[e]=t,this._changed.emit({type:"set",oldIndex:e,newIndex:e,oldValues:[s],newValues:[t]}))}push(e){const t=this._array.push(e);return this._changed.emit({type:"add",oldIndex:-1,newIndex:this.length-1,oldValues:[],newValues:[e]}),t}insert(e,t){u.ArrayExt.insert(this._array,e,t),this._changed.emit({type:"add",oldIndex:-1,newIndex:e,oldValues:[],newValues:[t]})}removeValue(e){const t=this._itemCmp,s=u.ArrayExt.findFirstIndex(this._array,(s=>t(s,e)));return this.remove(s),s}remove(e){const t=u.ArrayExt.removeAt(this._array,e);if(void 0!==t)return this._changed.emit({type:"remove",oldIndex:e,newIndex:-1,newValues:[],oldValues:[t]}),t}clear(){const e=this._array.slice();this._array.length=0,this._changed.emit({type:"remove",oldIndex:0,newIndex:0,newValues:[],oldValues:e})}move(e,t){if(this.length<=1||e===t)return;const s=[this._array[e]];u.ArrayExt.move(this._array,e,t),this._changed.emit({type:"move",oldIndex:e,newIndex:t,oldValues:s,newValues:s})}pushAll(e){const t=this.length;return(0,u.each)(e,(e=>{this._array.push(e)})),this._changed.emit({type:"add",oldIndex:-1,newIndex:t,oldValues:[],newValues:(0,u.toArray)(e)}),this.length}insertAll(e,t){const s=e;(0,u.each)(t,(t=>{u.ArrayExt.insert(this._array,e++,t)})),this._changed.emit({type:"add",oldIndex:-1,newIndex:s,oldValues:[],newValues:(0,u.toArray)(t)})}removeRange(e,t){const s=this._array.slice(e,t);for(let s=e;s<t;s++)u.ArrayExt.removeAt(this._array,e);return this._changed.emit({type:"remove",oldIndex:e,newIndex:-1,oldValues:s,newValues:[]}),this.length}}{constructor(e){super(),this._inCompound=!1,this._isUndoable=!0,this._madeCompoundChange=!1,this._index=-1,this._stack=[],this._serializer=e,this.changed.connect(this._onListChanged,this)}get canRedo(){return this._index<this._stack.length-1}get canUndo(){return this._index>=0}beginCompoundOperation(e){this._inCompound=!0,this._isUndoable=!1!==e,this._madeCompoundChange=!1}endCompoundOperation(){this._inCompound=!1,this._isUndoable=!0,this._madeCompoundChange&&this._index++}undo(){if(!this.canUndo)return;const e=this._stack[this._index];this._isUndoable=!1;for(const t of e.reverse())this._undoChange(t);this._isUndoable=!0,this._index--}redo(){if(!this.canRedo)return;this._index++;const e=this._stack[this._index];this._isUndoable=!1;for(const t of e)this._redoChange(t);this._isUndoable=!0}clearUndo(){this._index=-1,this._stack=[]}_onListChanged(e,t){if(this.isDisposed||!this._isUndoable)return;this._inCompound&&this._madeCompoundChange||(this._stack=this._stack.slice(0,this._index+1));const s=this._copyChange(t);this._stack[this._index+1]?this._stack[this._index+1].push(s):this._stack.push([s]),this._inCompound?this._madeCompoundChange=!0:this._index++}_undoChange(e){let t=0;const s=this._serializer;switch(e.type){case"add":(0,u.each)(e.newValues,(()=>{this.remove(e.newIndex)}));break;case"set":t=e.oldIndex,(0,u.each)(e.oldValues,(e=>{this.set(t++,s.fromJSON(e))}));break;case"remove":t=e.oldIndex,(0,u.each)(e.oldValues,(e=>{this.insert(t++,s.fromJSON(e))}));break;case"move":this.move(e.newIndex,e.oldIndex);break;default:return}}_redoChange(e){let t=0;const s=this._serializer;switch(e.type){case"add":t=e.newIndex,(0,u.each)(e.newValues,(e=>{this.insert(t++,s.fromJSON(e))}));break;case"set":t=e.newIndex,(0,u.each)(e.newValues,(t=>{this.set(e.newIndex++,s.fromJSON(t))}));break;case"remove":(0,u.each)(e.oldValues,(()=>{this.remove(e.oldIndex)}));break;case"move":this.move(e.oldIndex,e.newIndex);break;default:return}}_copyChange(e){const t=[];(0,u.each)(e.oldValues,(e=>{t.push(this._serializer.toJSON(e))}));const s=[];return(0,u.each)(e.newValues,(e=>{s.push(this._serializer.toJSON(e))})),{type:e.type,oldIndex:e.oldIndex,newIndex:e.newIndex,oldValues:t,newValues:s}}}!function(e){e.IdentitySerializer=class{toJSON(e){return e}fromJSON(e){return e}}}(_||(_={}));class p{constructor(e=null){this._value=null,this._changed=new n.Signal(this),this._isDisposed=!1,this._value=e}get type(){return"Value"}get isDisposed(){return this._isDisposed}get changed(){return this._changed}get(){return this._value}set(e){const t=this._value;o.JSONExt.deepEqual(t,e)||(this._value=e,this._changed.emit({oldValue:t,newValue:e}))}dispose(){this._isDisposed||(this._isDisposed=!0,n.Signal.clearData(this),this._value=null)}}!function(e){e.IChangedArgs=class{}}(p||(p={}));class m{constructor(e={}){this.isPrepopulated=!1,this.isCollaborative=!1,this.connected=Promise.resolve(void 0),this._toDispose=!1,this._isDisposed=!1,this._disposables=new a.DisposableSet,this._basePath=e.basePath||"",e.baseDB?this._db=e.baseDB:(this._db=new h.v,this._toDispose=!0)}get basePath(){return this._basePath}get isDisposed(){return this._isDisposed}get(e){return this._db.get(this._resolvePath(e))}has(e){return this._db.has(this._resolvePath(e))}createString(e){const t=new d;return this._disposables.add(t),this.set(e,t),t}createList(e){const t=new _(new _.IdentitySerializer);return this._disposables.add(t),this.set(e,t),t}createMap(e){const t=new r.T;return this._disposables.add(t),this.set(e,t),t}createValue(e){const t=new p;return this._disposables.add(t),this.set(e,t),t}getValue(e){const t=this.get(e);if(!t||"Value"!==t.type)throw Error("Can only call getValue for an ObservableValue");return t.get()}setValue(e,t){const s=this.get(e);if(!s||"Value"!==s.type)throw Error("Can only call setValue on an ObservableValue");s.set(t)}view(e){const t=new m({basePath:e,baseDB:this});return this._disposables.add(t),t}set(e,t){this._db.set(this._resolvePath(e),t)}dispose(){this.isDisposed||(this._isDisposed=!0,this._toDispose&&this._db.dispose(),this._disposables.dispose())}_resolvePath(e){return this._basePath&&(e=this._basePath+"."+e),e}}!function(e){e.defaultSelectionStyle={className:"",displayName:"",color:"black"},e.Model=class{constructor(e){this._mutex=(()=>{let e=!0;return t=>{if(e){e=!1;try{t()}finally{e=!0}}}})(),this._isDisposed=!1,this._mimeTypeChanged=new n.Signal(this),this._sharedModelSwitched=new n.Signal(this),(e=e||{}).modelDB?this.modelDB=e.modelDB:this.modelDB=new m,this.sharedModel=i.e4(this.type,e.id),this.sharedModel.changed.connect(this._onSharedModelChanged,this);const t=this.modelDB.createString("value");t.changed.connect(this._onModelDBValueChanged,this),t.text=t.text||e.value||"";const s=this.modelDB.createValue("mimeType");s.changed.connect(this._onModelDBMimeTypeChanged,this),s.set(e.mimeType||"text/plain"),this.modelDB.createMap("selections")}switchSharedModel(e,t){t&&(this.value.text=e.getSource()),this.sharedModel.changed.disconnect(this._onSharedModelChanged,this),this.sharedModel=e,this.sharedModel.changed.connect(this._onSharedModelChanged,this),this._sharedModelSwitched.emit(!0)}_onSharedModelChanged(e,t){this._mutex((()=>{if(t.sourceChange){const e=this.modelDB.get("value");let s=0;t.sourceChange.forEach((t=>{null!=t.insert?(e.insert(s,t.insert),s+=t.insert.length):null!=t.delete?e.remove(s,s+t.delete):null!=t.retain&&(s+=t.retain)}))}}))}_onModelDBValueChanged(e,t){this._mutex((()=>{this.sharedModel.transact((()=>{switch(t.type){case"insert":this.sharedModel.updateSource(t.start,t.start,t.value);break;case"remove":this.sharedModel.updateSource(t.start,t.end);break;default:this.sharedModel.setSource(e.text)}}))}))}get type(){return"code"}get mimeTypeChanged(){return this._mimeTypeChanged}get sharedModelSwitched(){return this._sharedModelSwitched}get value(){return this.modelDB.get("value")}get selections(){return this.modelDB.get("selections")}get mimeType(){return this.modelDB.getValue("mimeType")}set mimeType(e){this.mimeType!==e&&this.modelDB.setValue("mimeType",e)}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,n.Signal.clearData(this))}_onModelDBMimeTypeChanged(e,t){this._mimeTypeChanged.emit({name:"mimeType",oldValue:t.oldValue,newValue:t.newValue})}},e.defaultConfig={fontFamily:null,fontSize:null,lineHeight:null,lineNumbers:!1,lineWrap:"on",wordWrapColumn:80,readOnly:!1,tabSize:4,insertSpaces:!0,matchBrackets:!0,autoClosingBrackets:!0,handlePaste:!0,rulers:[],codeFolding:!1}}(c||(c={}));var g=s(66599),v=s(48992),y=s(77031);const x="jp-mod-error";class C extends y.Widget{constructor(e){super(),this._dataDirty=!1,this._inputDirty=!1,this._source=null,this._originalValue=o.JSONExt.emptyObject,this._changeGuard=!1,this.translator=e.translator||g.nullTranslator,this._trans=this.translator.load("jupyterlab"),this.addClass("jp-JSONEditor"),this.headerNode=document.createElement("div"),this.headerNode.className="jp-JSONEditor-header",this.revertButtonNode=v.undoIcon.element({tag:"span",title:this._trans.__("Revert changes to data")}),this.commitButtonNode=v.checkIcon.element({tag:"span",title:this._trans.__("Commit changes to data"),marginLeft:"8px"}),this.editorHostNode=document.createElement("div"),this.editorHostNode.className="jp-JSONEditor-host",this.headerNode.appendChild(this.revertButtonNode),this.headerNode.appendChild(this.commitButtonNode),this.node.appendChild(this.headerNode),this.node.appendChild(this.editorHostNode);const t=new c.Model;t.value.text=this._trans.__("No data!"),t.mimeType="application/json",t.value.changed.connect(this._onValueChanged,this),this.model=t,this.editor=e.editorFactory({host:this.editorHostNode,model:t}),this.editor.setOption("readOnly",!0)}get source(){return this._source}set source(e){this._source!==e&&(this._source&&this._source.changed.disconnect(this._onSourceChanged,this),this._source=e,this.editor.setOption("readOnly",null===e),e&&e.changed.connect(this._onSourceChanged,this),this._setValue())}get isDirty(){return this._dataDirty||this._inputDirty}handleEvent(e){switch(e.type){case"blur":this._evtBlur(e);break;case"click":this._evtClick(e)}}onAfterAttach(e){const t=this.editorHostNode;t.addEventListener("blur",this,!0),t.addEventListener("click",this,!0),this.revertButtonNode.hidden=!0,this.commitButtonNode.hidden=!0,this.headerNode.addEventListener("click",this),this.isVisible&&this.update()}onAfterShow(e){this.update()}onUpdateRequest(e){this.editor.refresh()}onBeforeDetach(e){const t=this.editorHostNode;t.removeEventListener("blur",this,!0),t.removeEventListener("click",this,!0),this.headerNode.removeEventListener("click",this)}_onSourceChanged(e,t){this._changeGuard||(this._inputDirty||this.editor.hasFocus()?this._dataDirty=!0:this._setValue())}_onValueChanged(){let e=!0;try{const e=JSON.parse(this.editor.model.value.text);this.removeClass(x),this._inputDirty=!this._changeGuard&&!o.JSONExt.deepEqual(e,this._originalValue)}catch(t){this.addClass(x),this._inputDirty=!0,e=!1}this.revertButtonNode.hidden=!this._inputDirty,this.commitButtonNode.hidden=!e||!this._inputDirty}_evtBlur(e){!this._inputDirty&&this._dataDirty&&this._setValue()}_evtClick(e){const t=e.target;this.revertButtonNode.contains(t)?this._setValue():this.commitButtonNode.contains(t)?this.commitButtonNode.hidden||this.hasClass(x)||(this._changeGuard=!0,this._mergeContent(),this._changeGuard=!1,this._setValue()):this.editorHostNode.contains(t)&&this.editor.focus()}_mergeContent(){const e=this.editor.model,t=this._originalValue,s=JSON.parse(e.value.text),i=this.source;if(i){for(const e in s)o.JSONExt.deepEqual(s[e],t[e]||null)||i.set(e,s[e]);for(const e in t)e in s||i.delete(e)}}_setValue(){this._dataDirty=!1,this._inputDirty=!1,this.revertButtonNode.hidden=!0,this.commitButtonNode.hidden=!0,this.removeClass(x);const e=this.editor.model,t=this._source?this._source.toJSON():{};if(this._changeGuard=!0,void 0===t)e.value.text=this._trans.__("No data!"),this._originalValue=o.JSONExt.emptyObject;else{const s=JSON.stringify(t,null,4);e.value.text=s,this._originalValue=t,s.length>1&&"{"===s[0]&&this.editor.setCursorPosition({line:0,column:1})}this.editor.refresh(),this._changeGuard=!1,this.commitButtonNode.hidden=!0,this.revertButtonNode.hidden=!0}}const f="jp-mod-has-primary-selection",D="jp-mod-in-leading-whitespace",w="jp-mod-dropTarget",S=/^\s+$/;class V extends y.Widget{constructor(e){super(),this._hasRefreshedSinceAttach=!1,(this.editor=e.factory({host:this.node,model:e.model,uuid:e.uuid,config:e.config,selectionStyle:e.selectionStyle})).model.selections.changed.connect(this._onSelectionsChanged,this),this._updateOnShow=!1!==e.updateOnShow}get model(){return this.editor.model}dispose(){this.isDisposed||(super.dispose(),this.editor.dispose())}handleEvent(e){switch(e.type){case"lm-dragenter":this._evtDragEnter(e);break;case"lm-dragleave":this._evtDragLeave(e);break;case"lm-dragover":this._evtDragOver(e);break;case"lm-drop":this._evtDrop(e)}}onActivateRequest(e){this.editor.focus()}onAfterAttach(e){super.onAfterAttach(e);const t=this.node;t.addEventListener("lm-dragenter",this),t.addEventListener("lm-dragleave",this),t.addEventListener("lm-dragover",this),t.addEventListener("lm-drop",this),this._hasRefreshedSinceAttach=!1,this.isVisible&&this.update()}onBeforeDetach(e){const t=this.node;t.removeEventListener("lm-dragenter",this),t.removeEventListener("lm-dragleave",this),t.removeEventListener("lm-dragover",this),t.removeEventListener("lm-drop",this)}onAfterShow(e){!this._updateOnShow&&this._hasRefreshedSinceAttach||this.update()}onResize(e){e.width>=0&&e.height>=0?this.editor.setSize(e):this.isVisible&&this.editor.resizeToFit()}onUpdateRequest(e){this.isVisible&&(this._hasRefreshedSinceAttach=!0,this.editor.refresh())}_onSelectionsChanged(){const{start:e,end:t}=this.editor.getSelection();e.column!==t.column||e.line!==t.line?(this.addClass(f),this.removeClass(D)):(this.removeClass(f),this.editor.getLine(t.line).slice(0,t.column).match(S)?this.addClass(D):this.removeClass(D))}_evtDragEnter(e){!0!==this.editor.getOption("readOnly")&&void 0!==b.findTextData(e.mimeData)&&(e.preventDefault(),e.stopPropagation(),this.addClass("jp-mod-dropTarget"))}_evtDragLeave(e){this.removeClass(w),!0!==this.editor.getOption("readOnly")&&void 0!==b.findTextData(e.mimeData)&&(e.preventDefault(),e.stopPropagation())}_evtDragOver(e){this.removeClass(w),!0!==this.editor.getOption("readOnly")&&void 0!==b.findTextData(e.mimeData)&&(e.preventDefault(),e.stopPropagation(),e.dropAction="copy",this.addClass(w))}_evtDrop(e){if(!0===this.editor.getOption("readOnly"))return;const t=b.findTextData(e.mimeData);if(void 0===t)return;const s={top:e.y,bottom:e.y,left:e.x,right:e.x,x:e.x,y:e.y,width:0,height:0},i=this.editor.getPositionForCoordinate(s);if(null===i)return;if(this.removeClass(w),e.preventDefault(),e.stopPropagation(),"none"===e.proposedAction)return void(e.dropAction="none");const n=this.editor.getOffsetAt(i);this.model.value.insert(n,t)}}var b,N;!function(e){e.findTextData=function(e){const t=e.types().find((e=>0===e.indexOf("text")));if(void 0!==t)return e.getData(t)}}(b||(b={})),function(e){e.defaultMimeType="text/plain"}(N||(N={}));const E=new o.Token("@jupyterlab/codeeditor:IEditorServices")},18718:(e,t,s)=>{"use strict";s.d(t,{T:()=>o});var i=s(66065),n=s(91884),a=s(1941);class o extends a.v{constructor(e={}){super({itemCmp:i.JSONExt.deepEqual,values:e.values})}toJSON(){const e=Object.create(null),t=this.keys();for(const s of t){const t=this.get(s);void 0!==t&&(e[s]=i.JSONExt.deepCopy(t))}return e}}!function(e){class t extends n.Message{constructor(e,t){super(e),this.args=t}}e.ChangeMessage=t}(o||(o={}))},1941:(e,t,s)=>{"use strict";s.d(t,{v:()=>a});var i,n=s(58137);class a{constructor(e={}){if(this._map=new Map,this._changed=new n.Signal(this),this._isDisposed=!1,this._itemCmp=e.itemCmp||i.itemCmp,e.values)for(const t in e.values)this._map.set(t,e.values[t])}get type(){return"Map"}get changed(){return this._changed}get isDisposed(){return this._isDisposed}get size(){return this._map.size}set(e,t){const s=this._map.get(e);if(void 0===t)throw Error("Cannot set an undefined value, use remove");const i=this._itemCmp;return void 0!==s&&i(s,t)||(this._map.set(e,t),this._changed.emit({type:s?"change":"add",key:e,oldValue:s,newValue:t})),s}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){const e=[];return this._map.forEach(((t,s)=>{e.push(s)})),e}values(){const e=[];return this._map.forEach(((t,s)=>{e.push(t)})),e}delete(e){const t=this._map.get(e);return this._map.delete(e)&&this._changed.emit({type:"remove",key:e,oldValue:t,newValue:void 0}),t}clear(){const e=this.keys();for(let t=0;t<e.length;t++)this.delete(e[t])}dispose(){this.isDisposed||(this._isDisposed=!0,n.Signal.clearData(this),this._map.clear())}}!function(e){e.itemCmp=function(e,t){return e===t}}(i||(i={}))}}]);
//# sourceMappingURL=4342.bundle.js.map