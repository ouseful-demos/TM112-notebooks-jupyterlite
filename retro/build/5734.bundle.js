(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[5734],{45734:(t,e,s)=>{"use strict";s.r(e),s.d(e,{AttachmentsCell:()=>ut,AttachmentsCellModel:()=>R,Cell:()=>dt,CellDragUtils:()=>l,CellFooter:()=>y,CellHeader:()=>_,CellModel:()=>H,CodeCell:()=>lt,CodeCellModel:()=>L,Collapser:()=>c,InputArea:()=>f,InputCollapser:()=>p,InputPlaceholder:()=>$,InputPrompt:()=>w,MarkdownCell:()=>ht,MarkdownCellModel:()=>T,OutputCollapser:()=>m,OutputPlaceholder:()=>z,Placeholder:()=>U,RawCell:()=>ct,RawCellModel:()=>V,isCodeCellModel:()=>P,isMarkdownCellModel:()=>W,isRawCellModel:()=>A});var n=s(79028),a=s(52522);const i="jp-dragImage",r="jp-dragImage-content",o="jp-dragImage-prompt",d="jp-dragImage-multipleBack";var l;!function(t){t.findCell=function(t,e,s){let a=-1;for(;t&&t.parentElement;){if(s(t)){(0,n.each)(e,((e,s)=>{if(e.node===t)return a=s,!1}));break}t=t.parentElement}return a},t.detectTargetArea=function(t,e){let s;return s=t?t.editorWidget.node.contains(e)?"input":t.promptNode.contains(e)?"prompt":"cell":"unknown",s},t.shouldStartDrag=function(t,e,s,n){const a=Math.abs(s-t),i=Math.abs(n-e);return a>=5||i>=5},t.createCellDragImage=function(t,e){const s=e.length;let n;if("code"===t.model.type){const e=t.model.executionCount;n=" ",e&&(n=e.toString())}else n="";const l=t.model.value.text.split("\n")[0].slice(0,26);return s>1?""!==n?a.VirtualDOM.realize(a.h.div(a.h.div({className:i},a.h.span({className:o},"["+n+"]:"),a.h.span({className:r},l)),a.h.div({className:d},""))):a.VirtualDOM.realize(a.h.div(a.h.div({className:i},a.h.span({className:o}),a.h.span({className:r},l)),a.h.div({className:d},""))):""!==n?a.VirtualDOM.realize(a.h.div(a.h.div({className:"jp-dragImage jp-dragImage-singlePrompt"},a.h.span({className:o},"["+n+"]:"),a.h.span({className:r},l)))):a.VirtualDOM.realize(a.h.div(a.h.div({className:"jp-dragImage jp-dragImage-singlePrompt"},a.h.span({className:o}),a.h.span({className:r},l))))}}(l||(l={}));var u=s(5599),h=s(96927);class c extends u.ReactWidget{constructor(){super(),this.addClass("jp-Collapser")}get collapsed(){return!1}render(){return h.createElement("div",{className:"jp-Collapser-child",onClick:t=>this.handleClick(t)})}}class p extends c{constructor(){super(),this.addClass("jp-InputCollapser")}get collapsed(){var t;const e=null===(t=this.parent)||void 0===t?void 0:t.parent;return!!e&&e.inputHidden}handleClick(t){var e;const s=null===(e=this.parent)||void 0===e?void 0:e.parent;s&&(s.inputHidden=!s.inputHidden),this.update()}}class m extends c{constructor(){super(),this.addClass("jp-OutputCollapser")}get collapsed(){var t;const e=null===(t=this.parent)||void 0===t?void 0:t.parent;return!!e&&e.outputHidden}handleClick(t){var e;const s=null===(e=this.parent)||void 0===e?void 0:e.parent;s&&(s.outputHidden=!s.outputHidden),this.update()}}var g=s(77031);class _ extends g.Widget{constructor(){super(),this.addClass("jp-CellHeader")}}class y extends g.Widget{constructor(){super(),this.addClass("jp-CellFooter")}}var C=s(46430),v=s(47661);class f extends g.Widget{constructor(t){super(),this.addClass("jp-InputArea");const e=this.model=t.model,s=this.contentFactory=t.contentFactory||f.defaultContentFactory,n=this._prompt=s.createInputPrompt();n.addClass("jp-InputArea-prompt");const a={model:e,factory:s.editorFactory,updateOnShow:t.updateOnShow},i=this._editor=new C.CodeEditorWrapper(a);i.addClass("jp-InputArea-editor");const r=this.layout=new g.PanelLayout;r.addWidget(n),r.addWidget(i)}get editorWidget(){return this._editor}get editor(){return this._editor.editor}get promptNode(){return this._prompt.node}renderInput(t){const e=this.layout;this._rendered&&(this._rendered.parent=null),this._editor.hide(),this._rendered=t,e.addWidget(t)}showEditor(){this._rendered&&(this._rendered.parent=null),this._editor.show()}setPrompt(t){this._prompt.executionCount=t}dispose(){this.isDisposed||(this._prompt=null,this._editor=null,this._rendered=null,super.dispose())}}!function(t){class e{constructor(e={}){this._editor=e.editorFactory||t.defaultEditorFactory}get editorFactory(){return this._editor}createInputPrompt(){return new w}}t.ContentFactory=e,t.defaultEditorFactory=(new v.CodeMirrorEditorFactory).newInlineEditor,t.defaultContentFactory=new e({})}(f||(f={}));class w extends g.Widget{constructor(){super(),this._executionCount=null,this.addClass("jp-InputPrompt")}get executionCount(){return this._executionCount}set executionCount(t){this._executionCount=t,this.node.textContent=null===t?" ":`[${t||" "}]:`}}var O=s(66065),x=s(58137),S=s(50266),b=s(3025);class M{constructor(t={}){if(this._map=new S.v,this._isDisposed=!1,this._stateChanged=new x.Signal(this),this._changed=new x.Signal(this),this._modelDB=null,this._serialized=null,this._changeGuard=!1,this.contentFactory=t.contentFactory||M.defaultContentFactory,t.values)for(const e of Object.keys(t.values))void 0!==t.values[e]&&this.set(e,t.values[e]);this._map.changed.connect(this._onMapChanged,this),t.modelDB&&(this._modelDB=t.modelDB,this._serialized=this._modelDB.createValue("attachments"),this._serialized.get()?this.fromJSON(this._serialized.get()):this._serialized.set(this.toJSON()),this._serialized.changed.connect(this._onSerializedChanged,this))}get stateChanged(){return this._stateChanged}get changed(){return this._changed}get keys(){return this._map.keys()}get length(){return this._map.keys().length}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._map.dispose(),x.Signal.clearData(this))}has(t){return this._map.has(t)}get(t){return this._map.get(t)}set(t,e){const s=this._createItem({value:e});this._map.set(t,s)}remove(t){this._map.delete(t)}clear(){this._map.values().forEach((t=>{t.dispose()})),this._map.clear()}fromJSON(t){this.clear(),Object.keys(t).forEach((e=>{void 0!==t[e]&&this.set(e,t[e])}))}toJSON(){const t={};for(const e of this._map.keys())t[e]=this._map.get(e).toJSON();return t}_createItem(t){const e=this.contentFactory.createAttachmentModel(t);return e.changed.connect(this._onGenericChange,this),e}_onMapChanged(t,e){this._serialized&&!this._changeGuard&&(this._changeGuard=!0,this._serialized.set(this.toJSON()),this._changeGuard=!1),this._changed.emit(e),this._stateChanged.emit(void 0)}_onSerializedChanged(t,e){this._changeGuard||(this._changeGuard=!0,this.fromJSON(e.newValue),this._changeGuard=!1)}_onGenericChange(){this._stateChanged.emit(void 0)}}!function(t){class e{createAttachmentModel(t){return new b.AttachmentModel(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(M||(M={}));class j{constructor(t){this._parent=t.parent||null,this._model=t.model}async resolveUrl(t){return this._parent&&!t.startsWith("attachment:")?this._parent.resolveUrl(t):t}async getDownloadUrl(t){if(this._parent&&!t.startsWith("attachment:"))return this._parent.getDownloadUrl(t);const e=t.slice("attachment:".length),s=this._model.get(e);if(void 0===s)return t;const{data:n}=s,a=Object.keys(n)[0];if(void 0===a||-1===b.imageRendererFactory.mimeTypes.indexOf(a))throw new Error(`Cannot render unknown image mime type "${a}".`);return`data:${a};base64,${n[a]}`}isLocal(t){var e,s,n;return!(this._parent&&!t.startsWith("attachment:"))||null===(n=null===(s=(e=this._parent).isLocal)||void 0===s?void 0:s.call(e,t))||void 0===n||n}}var I,D=s(90915),k=s(71102),E=s(87700);class N{constructor(t={}){this.clearNext=!1,this._trusted=!1,this._isDisposed=!1,this._stateChanged=new x.Signal(this),this._changed=new x.Signal(this),this._trusted=!!t.trusted,this.contentFactory=t.contentFactory||N.defaultContentFactory,this.list=new E.a,t.values&&(0,n.each)(t.values,(t=>{this._add(t)})),this.list.changed.connect(this._onListChanged,this)}get stateChanged(){return this._stateChanged}get changed(){return this._changed}get length(){return this.list?this.list.length:0}get trusted(){return this._trusted}set trusted(t){if(t===this._trusted)return;const e=this._trusted=t;for(let t=0;t<this.list.length;t++){let s=this.list.get(t);const n=s.toJSON();s.dispose(),s=this._createItem({value:n,trusted:e}),this.list.set(t,s)}}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this.list.dispose(),x.Signal.clearData(this))}get(t){return this.list.get(t)}set(t,e){e=O.JSONExt.deepCopy(e),I.normalize(e);const s=this._createItem({value:e,trusted:this._trusted});this.list.set(t,s)}add(t){return this.clearNext&&(this.clear(),this.clearNext=!1),this._add(t)}clear(t=!1){this._lastStream="",t?this.clearNext=!0:((0,n.each)(this.list,(t=>{t.dispose()})),this.list.clear())}fromJSON(t){this.clear(),(0,n.each)(t,(t=>{this._add(t)}))}toJSON(){return(0,n.toArray)((0,n.map)(this.list,(t=>t.toJSON())))}_add(t){const e=this._trusted;if(t=O.JSONExt.deepCopy(t),I.normalize(t),k.isStream(t)&&this._lastStream&&t.name===this._lastName&&this.shouldCombine({value:t,lastModel:this.list.get(this.length-1)})){this._lastStream+=t.text,this._lastStream=I.removeOverwrittenChars(this._lastStream),t.text=this._lastStream;const s=this._createItem({value:t,trusted:e}),n=this.length-1;return this.list.get(n).dispose(),this.list.set(n,s),n}k.isStream(t)&&(t.text=I.removeOverwrittenChars(t.text));const s=this._createItem({value:t,trusted:e});return k.isStream(t)?(this._lastStream=t.text,this._lastName=t.name):this._lastStream="",this.list.push(s)}shouldCombine(t){return!0}_createItem(t){const e=this.contentFactory.createOutputModel(t);return e.changed.connect(this._onGenericChange,this),e}_onListChanged(t,e){this._changed.emit(e)}_onGenericChange(){this._stateChanged.emit(void 0)}}!function(t){class e{createOutputModel(t){return new b.OutputModel(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(N||(N={})),function(t){t.normalize=function(t){k.isStream(t)&&Array.isArray(t.text)&&(t.text=t.text.join("\n"))},t.removeOverwrittenChars=function(t){return function(t){for(t=t.replace(/\r+\n/gm,"\n");t.search(/\r[^$]/g)>-1;){const e=t.match(/^(.*)\r+/m)[1];let s=t.match(/\r+(.*)$/m)[1];s+=e.slice(s.length,e.length),t=t.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,s)}return t}(function(t){let e=t;do{e=(t=e).replace(/[^\n]\x08/gm,"")}while(e.length<t.length);return t}(t))}}(I||(I={}));var F;function P(t){return"code"===t.type}function W(t){return"markdown"===t.type}function A(t){return"raw"===t.type}class H extends C.CodeEditor.Model{constructor(t){var e;super({modelDB:t.modelDB,id:t.id||(null===(e=t.cell)||void 0===e?void 0:e.id)||O.UUID.uuid4()}),this.contentChanged=new x.Signal(this),this.stateChanged=new x.Signal(this),this._modelDBMutex=D.M(),this.value.changed.connect(this.onGenericChange,this),this.modelDB.createValue("type").set(this.type);const s=this.modelDB.createMap("metadata");s.changed.connect(this.onModelDBMetadataChange,this),s.changed.connect(this.onGenericChange,this);const n=t.cell,a=this.modelDB.createValue("trusted");if(a.changed.connect(this.onTrustedChanged,this),!n)return void a.set(!1);a.set(!!n.metadata.trusted),delete n.metadata.trusted,Array.isArray(n.source)?this.value.text=n.source.join(""):this.value.text=n.source;const i=O.JSONExt.deepCopy(n.metadata);"raw"!==this.type&&delete i.format,"code"!==this.type&&(delete i.collapsed,delete i.scrolled);for(const t in i)s.set(t,i[t])}get type(){return"raw"}get id(){return this.sharedModel.getId()}get metadata(){return this.modelDB.get("metadata")}get trusted(){return this.modelDB.getValue("trusted")}set trusted(t){this.trusted!==t&&this.modelDB.setValue("trusted",t)}toJSON(){const t=Object.create(null);for(const e of this.metadata.keys()){const s=JSON.parse(JSON.stringify(this.metadata.get(e)));t[e]=s}return this.trusted&&(t.trusted=!0),{cell_type:this.type,source:this.value.text,metadata:t}}onTrustedChanged(t,e){}onModelDBMetadataChange(t,e){const s=this.sharedModel.getMetadata();this._modelDBMutex((()=>{switch(e.type){case"add":case"change":this._changeCellMetata(s,e);break;case"remove":delete s[e.key];break;default:throw new Error(`Invalid event type: ${e.type}`)}this.sharedModel.setMetadata(s)}))}_changeCellMetata(t,e){switch(e.key){case"jupyter":t.jupyter=e.newValue;break;case"collapsed":t.collapsed=e.newValue;break;case"name":t.name=e.newValue;break;case"scrolled":t.scrolled=e.newValue;break;case"tags":t.tags=e.newValue;break;case"trusted":t.trusted=e.newValue;break;default:t[e.key]=e.newValue}}_onSharedModelChanged(t,e){super._onSharedModelChanged(t,e),this._modelDBMutex((()=>{var t;if(e.metadataChange){const s=null===(t=e.metadataChange)||void 0===t?void 0:t.newValue;s&&Object.keys(s).map((t=>{switch(t){case"collapsed":this.metadata.set("collapsed",s.jupyter);break;case"jupyter":this.metadata.set("jupyter",s.jupyter);break;case"name":this.metadata.set("name",s.name);break;case"scrolled":this.metadata.set("scrolled",s.scrolled);break;case"tags":this.metadata.set("tags",s.tags);break;case"trusted":this.metadata.set("trusted",s.trusted);break;default:this.metadata.set(t,s[t])}}))}}))}onGenericChange(){this.contentChanged.emit(void 0)}}class R extends H{constructor(t){super(t);const e=t.contentFactory||R.defaultContentFactory;let s;const n=t.cell;!n||"raw"!==n.cell_type&&"markdown"!==n.cell_type||(s=n.attachments),this._attachments=e.createAttachmentsModel({values:s,modelDB:this.modelDB}),this._attachments.stateChanged.connect(this.onGenericChange,this)}get attachments(){return this._attachments}toJSON(){const t=super.toJSON();return this.attachments.length&&(t.attachments=this.attachments.toJSON()),t}}!function(t){class e{createAttachmentsModel(t){return new M(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(R||(R={}));class V extends R{get type(){return"raw"}toJSON(){const t=super.toJSON();return t.id=this.id,t}}class T extends R{constructor(t){super(t),this.mimeType="text/x-ipythongfm"}get type(){return"markdown"}toJSON(){const t=super.toJSON();return t.id=this.id,t}}class L extends H{constructor(t){super(t);const e=t.contentFactory||L.defaultContentFactory,s=this.trusted,n=t.cell;let a=[];const i=this.modelDB.createValue("executionCount");if(i.get()||(n&&"code"===n.cell_type?(i.set(n.execution_count||null),a=n.outputs):i.set(null)),i.changed.connect(this._onExecutionCountChanged,this),this._modelDBMutex((()=>{this.sharedModel.setOutputs(null!=a?a:[])})),this._outputs=e.createOutputArea({trusted:s,values:a}),this._outputs.changed.connect(this.onGenericChange,this),this._outputs.changed.connect(this.onModelDBOutputsChange,this),this.metadata.changed.connect(F.collapseChanged,this),this.metadata.has("collapsed")){const t=this.metadata.get("collapsed");F.collapseChanged(this.metadata,{type:"change",key:"collapsed",oldValue:t,newValue:t})}else if(this.metadata.has("jupyter")){const t=this.metadata.get("jupyter");t.hasOwnProperty("outputs_hidden")&&F.collapseChanged(this.metadata,{type:"change",key:"jupyter",oldValue:t,newValue:t})}}switchSharedModel(t,e){e&&(this.clearExecution(),t.getOutputs().forEach((t=>this._outputs.add(t)))),super.switchSharedModel(t,e)}get type(){return"code"}get executionCount(){return this.modelDB.getValue("executionCount")}set executionCount(t){t!==this.executionCount&&this.modelDB.setValue("executionCount",t||null)}clearExecution(){this.outputs.clear(),this.executionCount=null,this.metadata.delete("execution")}get outputs(){return this._outputs}dispose(){this.isDisposed||(this._outputs.dispose(),this._outputs=null,super.dispose())}toJSON(){const t=super.toJSON();return t.execution_count=this.executionCount||null,t.outputs=this.outputs.toJSON(),t.id=this.id,t}onTrustedChanged(t,e){this._outputs&&(this._outputs.trusted=e.newValue),this.stateChanged.emit({name:"trusted",oldValue:e.oldValue,newValue:e.newValue})}onModelDBOutputsChange(t,e){const s=this.sharedModel;this._modelDBMutex((()=>{switch(e.type){case"add":{const t=e.newValues.map((t=>t.toJSON()));s.updateOutputs(e.newIndex,e.newIndex+t.length,t);break}case"set":{const t=e.newValues.map((t=>t.toJSON()));s.updateOutputs(e.oldIndex,e.oldValues.length,t);break}case"remove":s.updateOutputs(e.oldIndex,e.oldValues.length);break;default:throw new Error(`Invalid event type: ${e.type}`)}}))}_onSharedModelChanged(t,e){super._onSharedModelChanged(t,e),this._modelDBMutex((()=>{e.outputsChange&&(this.clearExecution(),t.getOutputs().forEach((t=>this._outputs.add(t)))),e.executionCountChange&&(this.executionCount=e.executionCountChange.newValue?e.executionCountChange.newValue:null)}))}_onExecutionCountChanged(t,e){const s=this.sharedModel;this._modelDBMutex((()=>{s.execution_count=e.newValue?e.newValue:null})),this.contentChanged.emit(void 0),this.stateChanged.emit({name:"executionCount",oldValue:e.oldValue,newValue:e.newValue})}}!function(t){class e{createOutputArea(t){return new N(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(L||(L={})),function(t){t.collapseChanged=function(t,e){if("collapsed"===e.key){const s=t.get("jupyter")||{},{outputs_hidden:n}=s,a=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]])}return s}(s,["outputs_hidden"]);n!==e.newValue&&(void 0!==e.newValue&&(a.outputs_hidden=e.newValue),0===Object.keys(a).length?t.delete("jupyter"):t.set("jupyter",a))}else if("jupyter"===e.key){const s=e.newValue||{};s.hasOwnProperty("outputs_hidden")?t.set("collapsed",s.outputs_hidden):t.delete("collapsed")}}}(F||(F={}));var J=s(31007);const B="jp-Placeholder-content";class U extends u.ReactWidget{constructor(t){super(),this.addClass("jp-Placeholder"),this._callback=t}handleClick(t){(0,this._callback)(t)}}class $ extends U{constructor(t){super(t),this.addClass("jp-InputPlaceholder")}render(){return[h.createElement("div",{className:"jp-Placeholder-prompt jp-InputPrompt",key:"input"}),h.createElement("div",{className:B,onClick:t=>this.handleClick(t),key:"content"},h.createElement(J.ellipsesIcon.react,{className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}))]}}class z extends U{constructor(t){super(t),this.addClass("jp-OutputPlaceholder")}render(){return[h.createElement("div",{className:"jp-Placeholder-prompt jp-OutputPrompt",key:"output"}),h.createElement("div",{className:B,onClick:t=>this.handleClick(t),key:"content"},h.createElement(J.ellipsesIcon.react,{className:"jp-MoreHorizIcon",elementPosition:"center",height:"auto",width:"32px"}))]}}var G=s(42593),q=s(97209),Y=s(20337),K=s(32120);const X="jp-OutputArea-child",Z="jp-OutputArea-output",Q="jp-OutputArea-prompt";class tt extends g.Widget{constructor(t){super(),this.outputLengthChanged=new x.Signal(this),this._onIOPub=t=>{const e=this.model,s=t.header.msg_type;let n;const a=(t.content.transient||{}).display_id;let i;switch(s){case"execute_result":case"display_data":case"stream":case"error":n=Object.assign(Object.assign({},t.content),{output_type:s}),e.add(n);break;case"clear_output":{const s=t.content.wait;e.clear(s);break}case"update_display_data":if(n=Object.assign(Object.assign({},t.content),{output_type:"display_data"}),i=this._displayIdMap.get(a),i)for(const t of i)e.set(t,n)}a&&"display_data"===s&&(i=this._displayIdMap.get(a)||[],i.push(e.length-1),this._displayIdMap.set(a,i))},this._onExecuteReply=t=>{const e=this.model,s=t.content;if("ok"!==s.status)return;const n=s&&s.payload;if(!n||!n.length)return;const a=n.filter((t=>"page"===t.source));if(!a.length)return;const i={output_type:"display_data",data:JSON.parse(JSON.stringify(a[0])).data,metadata:{}};e.add(i)},this._minHeightTimeout=null,this._displayIdMap=new Map;const e=this.model=t.model;this.addClass("jp-OutputArea"),this.rendermime=t.rendermime,this.contentFactory=t.contentFactory||tt.defaultContentFactory,this.layout=new g.PanelLayout,this.trimmedOutputModels=new Array,this.maxNumberOutputs=t.maxNumberOutputs||0,this.headTailNumberOutputs=Math.round(this.maxNumberOutputs/2),this.headEndIndex=this.headTailNumberOutputs;for(let t=0;t<e.length;t++){const s=e.get(t);this._insertOutput(t,s)}e.changed.connect(this.onModelChanged,this),e.stateChanged.connect(this.onStateChanged,this)}get widgets(){return this.layout.widgets}get future(){return this._future}set future(t){if(this.model.isDisposed)throw Error("Model is disposed");this._future!==t&&(this._future&&this._future.dispose(),this._future=t,this.model.clear(),this.widgets.length&&(this._clear(),this.outputLengthChanged.emit(this.model.length)),t.onIOPub=this._onIOPub,t.onReply=this._onExecuteReply,t.onStdin=e=>{K.KernelMessage.isInputRequestMsg(e)&&this.onInputRequest(e,t)})}dispose(){this._future&&(this._future.dispose(),this._future=null),this._displayIdMap.clear(),super.dispose()}onModelChanged(t,e){switch(e.type){case"add":this._insertOutput(e.newIndex,e.newValues[0]),this.outputLengthChanged.emit(this.model.length);break;case"remove":if(this.widgets.length){if(0===this.model.length)this._clear();else{const t=e.oldIndex;for(let s=0;s<e.oldValues.length&&t<this.widgets.length;++s){const e=this.widgets[t];e.parent=null,e.dispose()}this._moveDisplayIdIndices(t,e.oldValues.length),this._preventHeightChangeJitter()}this.outputLengthChanged.emit(this.model.length)}break;case"set":this._setOutput(e.newIndex,e.newValues[0]),this.outputLengthChanged.emit(this.model.length)}}_moveDisplayIdIndices(t,e){this._displayIdMap.forEach((s=>{const n=t+e;for(let a=s.length-1;a>=0;--a){const i=s[a];i>=t&&i<n?s.splice(a,1):i>=n&&(s[a]-=e)}}))}onStateChanged(t){this.trimmedOutputModels=new Array;for(let t=0;t<this.model.length;t++)this._setOutput(t,this.model.get(t));this.outputLengthChanged.emit(this.model.length)}_clear(){if(!this.widgets.length)return;const t=this.widgets.length;for(let e=0;e<t;e++){const t=this.widgets[0];t.parent=null,t.dispose()}this._displayIdMap.clear(),this._preventHeightChangeJitter()}_preventHeightChangeJitter(){const t=this.node.getBoundingClientRect();this.node.style.minHeight=`${t.height}px`,this._minHeightTimeout&&window.clearTimeout(this._minHeightTimeout),this._minHeightTimeout=window.setTimeout((()=>{this.isDisposed||(this.node.style.minHeight="")}),50)}onInputRequest(t,e){const s=this.contentFactory,n=t.content.prompt,a=t.content.password,i=new g.Panel;i.addClass(X),i.addClass("jp-OutputArea-stdin-item");const r=s.createOutputPrompt();r.addClass(Q),i.addWidget(r);const o=s.createStdin({prompt:n,password:a,future:e});o.addClass(Z),i.addWidget(o),this.layout.addWidget(i),o.value.then((t=>{this.model.add({output_type:"stream",name:"stdin",text:t+"\n"}),i.dispose()}))}_setOutput(t,e){const s=this.layout,n=s.widgets[t],a=n.widgets?n.widgets[1]:n,i=this.rendermime.preferredMimeType(e.data,e.trusted?"any":"ensure");a.renderModel&&at.currentPreferredMimetype.get(a)===i&&tt.isIsolated(i,e.metadata)===a instanceof at.IsolatedRenderer?a.renderModel(e):(s.widgets[t].dispose(),this._insertOutput(t,e))}_insertOutput(t,e){if(0===t&&(this.trimmedOutputModels=new Array),t===this.maxNumberOutputs&&0!==this.maxNumberOutputs){const t=this.model.contentFactory.createOutputModel({value:{output_type:"display_data",data:{"text/html":`\n              <a style="margin: 10px; text-decoration: none;">\n                <pre>Output of this cell has been trimmed on the initial display.</pre>\n                <pre>Displaying the first ${this.maxNumberOutputs} top and last bottom outputs.</pre>\n                <pre>Click on this message to get the complete output.</pre>\n              </a>\n              `}}}),e=()=>this._showTrimmedOutputs(this.headTailNumberOutputs),s=this.createOutputItem(t);s.node.addEventListener("click",e),this.layout.insertWidget(this.headEndIndex,s)}const s=this._createOutput(e),n=this.layout;t<this.maxNumberOutputs||0===this.maxNumberOutputs?n.insertWidget(t,s):t>=this.maxNumberOutputs&&(n.removeWidgetAt(this.headTailNumberOutputs+1),n.insertWidget(t,s)),t>=this.headTailNumberOutputs&&0!==this.maxNumberOutputs&&this.trimmedOutputModels.push(e)}_createOutput(t){let e=this.createOutputItem(t);return e?e.toggleClass("jp-OutputArea-executeResult",null!==t.executionCount):e=new g.Widget,e}_showTrimmedOutputs(t){const e=this.layout;e.removeWidgetAt(t);for(let s=0;s<this.trimmedOutputModels.length-this.headTailNumberOutputs;s++){const n=this._createOutput(this.trimmedOutputModels[s]);e.insertWidget(t+s,n)}}createOutputItem(t){const e=this.createRenderedMimetype(t);if(!e)return null;const s=new g.Panel;s.addClass(X);const n=this.contentFactory.createOutputPrompt();return n.executionCount=t.executionCount,n.addClass(Q),s.addWidget(n),e.addClass(Z),s.addWidget(e),s}createRenderedMimetype(t){const e=this.rendermime.preferredMimeType(t.data,t.trusted?"any":"ensure");if(!e)return null;let s=this.rendermime.createRenderer(e);return!0===tt.isIsolated(e,t.metadata)&&(s=new at.IsolatedRenderer(s)),at.currentPreferredMimetype.set(s,e),s.renderModel(t).catch((t=>{const e=document.createElement("pre");e.textContent=`Javascript Error: ${t.message}`,s.node.appendChild(e),s.node.className="lm-Widget jp-RenderedText",s.node.setAttribute("data-mime-type","application/vnd.jupyter.stderr")})),s}}class et extends tt{onInputRequest(t,e){}createOutputItem(t){const e=this.createRenderedMimetype(t);return e&&e.addClass(Z),e}}!function(t){t.execute=async function(t,e,s,n){var a;let i=!0;n&&Array.isArray(n.tags)&&-1!==n.tags.indexOf("raises-exception")&&(i=!1);const r={code:t,stop_on_error:i},o=null===(a=s.session)||void 0===a?void 0:a.kernel;if(!o)throw new Error("Session has no kernel.");const d=o.requestExecute(r,!1,n);return e.future=d,d.done},t.isIsolated=function(t,e){const s=e[t];return s&&void 0!==s.isolated?!!s.isolated:!!e.isolated};class e{createOutputPrompt(){return new st}createStdin(t){return new nt(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(tt||(tt={}));class st extends g.Widget{constructor(){super(),this._executionCount=null,this.addClass("jp-OutputPrompt")}get executionCount(){return this._executionCount}set executionCount(t){this._executionCount=t,this.node.textContent=null===t?"":`[${t}]:`}}class nt extends g.Widget{constructor(t){super({node:at.createInputWidgetNode(t.prompt,t.password)}),this._promise=new O.PromiseDelegate,this.addClass("jp-Stdin"),this._input=this.node.getElementsByTagName("input")[0],this._input.focus(),this._future=t.future,this._value=t.prompt+" "}get value(){return this._promise.promise.then((()=>this._value))}handleEvent(t){const e=this._input;"keydown"===t.type&&13===t.keyCode&&(this._future.sendInputReply({status:"ok",value:e.value}),"password"===e.type?this._value+=Array(e.value.length+1).join("·"):this._value+=e.value,this._promise.resolve(void 0))}onAfterAttach(t){this._input.addEventListener("keydown",this),this.update()}onUpdateRequest(t){this._input.focus()}onBeforeDetach(t){this._input.removeEventListener("keydown",this)}}var at;!function(t){t.createInputWidgetNode=function(t,e){const s=document.createElement("div"),n=document.createElement("pre");n.className="jp-Stdin-prompt",n.textContent=t;const a=document.createElement("input");return a.className="jp-Stdin-input",e&&(a.type="password"),s.appendChild(n),n.appendChild(a),s};class e extends g.Widget{constructor(t){super({node:document.createElement("iframe")}),this.addClass("jp-mod-isolated"),this._wrapped=t;const e=this.node;e.frameBorder="0",e.scrolling="auto",e.addEventListener("load",(()=>{e.contentDocument.open(),e.contentDocument.write(this._wrapped.node.innerHTML),e.contentDocument.close();const t=e.contentDocument.body;e.style.height=`${t.scrollHeight}px`,e.heightChangeObserver=new q.Z((()=>{e.style.height=`${t.scrollHeight}px`})),e.heightChangeObserver.observe(t)}))}renderModel(t){return this._wrapped.renderModel(t)}}t.IsolatedRenderer=e,t.currentPreferredMimetype=new Y.AttachedProperty({name:"preferredMimetype",create:t=>""})}(at||(at={}));const it="jp-mod-rendered",rt="jp-mod-noOutputs",ot="application/x-jupyter-icontentsrich";class dt extends g.Widget{constructor(t){super(),this._readOnly=!1,this._inputHidden=!1,this._syncCollapse=!1,this._syncEditable=!1,this.addClass("jp-Cell");const e=this._model=t.model,s=this.contentFactory=t.contentFactory||dt.defaultContentFactory;this.layout=new g.PanelLayout;const n=s.createCellHeader();n.addClass("jp-Cell-header"),this.layout.addWidget(n);const a=this._inputWrapper=new g.Panel;a.addClass("jp-Cell-inputWrapper");const i=new p;i.addClass("jp-Cell-inputCollapser");const r=this._input=new f({model:e,contentFactory:s,updateOnShow:t.updateEditorOnShow});r.addClass("jp-Cell-inputArea"),a.addWidget(i),a.addWidget(r),this.layout.addWidget(a),this._inputPlaceholder=new $((()=>{this.inputHidden=!this.inputHidden}));const o=this.contentFactory.createCellFooter();if(o.addClass("jp-Cell-footer"),this.layout.addWidget(o),t.editorConfig){let e={};Object.keys(t.editorConfig).forEach((s=>{var n,a;e[s]=null!==(a=null===(n=t.editorConfig)||void 0===n?void 0:n[s])&&void 0!==a?a:null})),this.editor.setOptions(e)}e.metadata.changed.connect(this.onMetadataChanged,this)}initializeState(){return this.loadCollapseState(),this.loadEditableState(),this}get promptNode(){return this._inputHidden?this._inputPlaceholder.node.firstElementChild:this._input.promptNode}get editorWidget(){return this._input.editorWidget}get editor(){return this._input.editor}get model(){return this._model}get inputArea(){return this._input}get readOnly(){return this._readOnly}set readOnly(t){t!==this._readOnly&&(this._readOnly=t,this.syncEditable&&this.saveEditableState(),this.update())}saveEditableState(){const{metadata:t}=this.model,e=t.get("editable");this.readOnly&&!1===e||!this.readOnly&&void 0===e||(this.readOnly?this.model.metadata.set("editable",!1):this.model.metadata.delete("editable"))}loadEditableState(){this.readOnly=!1===this.model.metadata.get("editable")}get ready(){return Promise.resolve(void 0)}setPrompt(t){this._input.setPrompt(t)}get inputHidden(){return this._inputHidden}set inputHidden(t){if(this._inputHidden===t)return;const e=this._inputWrapper.layout;t?(this._input.parent=null,e.addWidget(this._inputPlaceholder)):(this._inputPlaceholder.parent=null,e.addWidget(this._input)),this._inputHidden=t,this.syncCollapse&&this.saveCollapseState(),this.handleInputHidden(t)}saveCollapseState(){const t=Object.assign({},this.model.metadata.get("jupyter"));this.inputHidden&&!0===t.source_hidden||!this.inputHidden&&void 0===t.source_hidden||(this.inputHidden?t.source_hidden=!0:delete t.source_hidden,0===Object.keys(t).length?this.model.metadata.delete("jupyter"):this.model.metadata.set("jupyter",t))}loadCollapseState(){const t=this.model.metadata.get("jupyter")||{};this.inputHidden=!!t.source_hidden}handleInputHidden(t){}get syncCollapse(){return this._syncCollapse}set syncCollapse(t){this._syncCollapse!==t&&(this._syncCollapse=t,t&&this.loadCollapseState())}get syncEditable(){return this._syncEditable}set syncEditable(t){this._syncEditable!==t&&(this._syncEditable=t,t&&this.loadEditableState())}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory})}dispose(){this.isDisposed||(this._input=null,this._model=null,this._inputWrapper=null,this._inputPlaceholder=null,super.dispose())}onAfterAttach(t){this.update()}onActivateRequest(t){this.editor.focus()}onFitRequest(t){this.editor.refresh()}onUpdateRequest(t){this._model&&this.editor.getOption("readOnly")!==this._readOnly&&(this.editor.setOption("readOnly",this._readOnly),this.toggleClass("jp-mod-readOnly",this._readOnly))}onMetadataChanged(t,e){switch(e.key){case"jupyter":this.syncCollapse&&this.loadCollapseState();break;case"editable":this.syncEditable&&this.loadEditableState()}}}!function(t){class e{constructor(t={}){this._editorFactory=t.editorFactory||f.defaultEditorFactory}get editorFactory(){return this._editorFactory}createCellHeader(){return new _}createCellFooter(){return new y}createInputPrompt(){return new w}createOutputPrompt(){return new st}createStdin(t){return new nt(t)}}t.ContentFactory=e,t.defaultContentFactory=new e}(dt||(dt={}));class lt extends dt{constructor(t){super(t),this._outputHidden=!1,this._syncScrolled=!1,this._savingMetadata=!1,this.addClass("jp-CodeCell");const e=this._rendermime=t.rendermime,s=this.contentFactory,n=this.model,a=this._outputWrapper=new g.Panel;a.addClass("jp-Cell-outputWrapper");const i=new m;i.addClass("jp-Cell-outputCollapser");const r=this._output=new tt({model:n.outputs,rendermime:e,contentFactory:s,maxNumberOutputs:t.maxNumberOutputs});r.addClass("jp-Cell-outputArea"),0===n.outputs.length&&this.addClass(rt),r.outputLengthChanged.connect(this._outputLengthHandler,this),a.addWidget(i),a.addWidget(r),this.layout.insertWidget(2,a),this._outputPlaceholder=new z((()=>{this.outputHidden=!this.outputHidden})),n.stateChanged.connect(this.onStateChanged,this)}initializeState(){return super.initializeState(),this.loadScrolledState(),this.setPrompt(`${this.model.executionCount||""}`),this}get outputArea(){return this._output}get outputHidden(){return this._outputHidden}set outputHidden(t){if(this._outputHidden===t)return;const e=this._outputWrapper.layout;t?(e.removeWidget(this._output),e.addWidget(this._outputPlaceholder),this.inputHidden&&!this._outputWrapper.isHidden&&this._outputWrapper.hide()):(this._outputWrapper.isHidden&&this._outputWrapper.show(),e.removeWidget(this._outputPlaceholder),e.addWidget(this._output)),this._outputHidden=t,this.syncCollapse&&this.saveCollapseState()}saveCollapseState(){this._savingMetadata=!0;try{super.saveCollapseState();const t=this.model.metadata,e=this.model.metadata.get("collapsed");if(this.outputHidden&&!0===e||!this.outputHidden&&void 0===e)return;this.outputHidden?t.set("collapsed",!0):t.delete("collapsed")}finally{this._savingMetadata=!1}}loadCollapseState(){super.loadCollapseState(),this.outputHidden=!!this.model.metadata.get("collapsed")}get outputsScrolled(){return this._outputsScrolled}set outputsScrolled(t){this.toggleClass("jp-mod-outputsScrolled",t),this._outputsScrolled=t,this.syncScrolled&&this.saveScrolledState()}saveScrolledState(){const{metadata:t}=this.model,e=t.get("scrolled");this.outputsScrolled&&!0===e||!this.outputsScrolled&&void 0===e||(this.outputsScrolled?t.set("scrolled",!0):t.delete("scrolled"))}loadScrolledState(){const t=this.model.metadata;"auto"===t.get("scrolled")?this.outputsScrolled=!1:this.outputsScrolled=!!t.get("scrolled")}get syncScrolled(){return this._syncScrolled}set syncScrolled(t){this._syncScrolled!==t&&(this._syncScrolled=t,t&&this.loadScrolledState())}handleInputHidden(t){!t&&this._outputWrapper.isHidden?this._outputWrapper.show():t&&!this._outputWrapper.isHidden&&this._outputHidden&&this._outputWrapper.hide()}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime})}cloneOutputArea(){return new et({model:this.model.outputs,contentFactory:this.contentFactory,rendermime:this._rendermime})}dispose(){this.isDisposed||(this._output.outputLengthChanged.disconnect(this._outputLengthHandler,this),this._rendermime=null,this._output=null,this._outputWrapper=null,this._outputPlaceholder=null,super.dispose())}onStateChanged(t,e){switch(e.name){case"executionCount":this.setPrompt(`${t.executionCount||""}`)}}onMetadataChanged(t,e){if(!this._savingMetadata){switch(e.key){case"scrolled":this.syncScrolled&&this.loadScrolledState();break;case"collapsed":this.syncCollapse&&this.loadCollapseState()}super.onMetadataChanged(t,e)}}_outputLengthHandler(t,e){const s=0===e;this.toggleClass(rt,s)}}!function(t){t.execute=async function(t,e,s){var n;const a=t.model,i=a.value.text;if(!i.trim()||!(null===(n=e.session)||void 0===n?void 0:n.kernel))return void a.clearExecution();const r={cellId:a.id};s=Object.assign(Object.assign(Object.assign({},a.metadata.toJSON()),s),r);const{recordTiming:o}=s;let d;a.clearExecution(),t.outputHidden=!1,t.setPrompt("*"),a.trusted=!0;try{const n=tt.execute(i,t.outputArea,e,s);if(o){const e=t=>{let e;switch(t.header.msg_type){case"status":e=`status.${t.content.execution_state}`;break;case"execute_input":e="execute_input";break;default:return!0}const s=t.header.date||(new Date).toISOString(),n=Object.assign({},a.metadata.get("execution"));return n[`iopub.${e}`]=s,a.metadata.set("execution",n),!0};t.outputArea.future.registerMessageHook(e)}else a.metadata.delete("execution");d=t.outputArea.future;const r=await n;if(a.executionCount=r.content.execution_count,o){const t=Object.assign({},a.metadata.get("execution")),e=r.metadata.started;e&&(t["shell.execute_reply.started"]=e);const s=r.header.date;t["shell.execute_reply"]=s||(new Date).toISOString(),a.metadata.set("execution",t)}return r}catch(e){throw d&&!t.isDisposed&&t.outputArea.future===d&&t.setPrompt(""),e}}}(lt||(lt={}));class ut extends dt{handleEvent(t){switch(t.type){case"paste":this._evtPaste(t);break;case"dragenter":case"dragover":t.preventDefault();break;case"drop":this._evtNativeDrop(t);break;case"lm-dragover":this._evtDragOver(t);break;case"lm-drop":this._evtDrop(t)}}onAfterAttach(t){super.onAfterAttach(t);const e=this.node;e.addEventListener("lm-dragover",this),e.addEventListener("lm-drop",this),e.addEventListener("dragenter",this),e.addEventListener("dragover",this),e.addEventListener("drop",this),e.addEventListener("paste",this)}onBeforeDetach(t){const e=this.node;e.removeEventListener("drop",this),e.removeEventListener("dragover",this),e.removeEventListener("dragenter",this),e.removeEventListener("paste",this),e.removeEventListener("lm-dragover",this),e.removeEventListener("lm-drop",this)}_evtDragOver(t){(0,n.some)(b.imageRendererFactory.mimeTypes,(e=>!!t.mimeData.hasData(ot)&&t.mimeData.getData(ot).model.mimetype===e))&&(t.preventDefault(),t.stopPropagation(),t.dropAction=t.proposedAction)}_evtPaste(t){if(t.clipboardData){const e=t.clipboardData.items;for(let s=0;s<e.length;s++){if("text/plain"===e[s].type){if(s<e.length-1&&"file"===e[s+1].kind)continue;e[s].getAsString((t=>{var e,s;null===(s=(e=this.editor).replaceSelection)||void 0===s||s.call(e,t)}))}this._attachFiles(t.clipboardData.items)}}t.preventDefault()}_evtNativeDrop(t){t.dataTransfer&&this._attachFiles(t.dataTransfer.items),t.preventDefault()}_evtDrop(t){const e=(0,n.toArray)((0,n.filter)(t.mimeData.types(),(e=>{if(e===ot){const e=t.mimeData.getData(ot);return-1!==b.imageRendererFactory.mimeTypes.indexOf(e.model.mimetype)}return-1!==b.imageRendererFactory.mimeTypes.indexOf(e)})));if(0!==e.length)if(t.preventDefault(),t.stopPropagation(),"none"!==t.proposedAction){t.dropAction="copy";for(const s of e)if(s===ot){const{model:e,withContent:s}=t.mimeData.getData(ot);if("file"===e.type){const t=this._generateURI(e.name);this.updateCellSourceWithAttachment(e.name,t),s().then((e=>{this.model.attachments.set(t,{[e.mimetype]:e.content})}))}}else{const e=this._generateURI();this.model.attachments.set(e,{[s]:t.mimeData.getData(s)}),this.updateCellSourceWithAttachment(e,e)}}else t.dropAction="none"}_attachFiles(t){for(let e=0;e<t.length;e++){const s=t[e];if("file"===s.kind){const t=s.getAsFile();t&&this._attachFile(t)}}}_attachFile(t){const e=new FileReader;e.onload=s=>{const{href:n,protocol:a}=G.URLExt.parse(e.result);if("data:"!==a)return;const i=/([\w+\/\+]+)?(?:;(charset=[\w\d-]*|base64))?,(.*)/.exec(n);if(!i||4!==i.length)return;const r=i[1],o={[r]:i[3]},d=this._generateURI(t.name);r.startsWith("image/")&&(this.model.attachments.set(d,o),this.updateCellSourceWithAttachment(t.name,d))},e.onerror=e=>{console.error(`Failed to attach ${t.name}`+e)},e.readAsDataURL(t)}_generateURI(t=""){const e=t.lastIndexOf(".");return-1!==e?O.UUID.uuid4().concat(t.substring(e)):O.UUID.uuid4()}}class ht extends ut{constructor(t){var e;super(t),this._renderer=null,this._rendered=!0,this._prevText="",this._ready=new O.PromiseDelegate,this.addClass("jp-MarkdownCell"),this._rendermime=t.rendermime.clone({resolver:new j({parent:null!==(e=t.rendermime.resolver)&&void 0!==e?e:void 0,model:this.model.attachments})}),this.editor.setOption("handlePaste",!1),this._monitor=new G.ActivityMonitor({signal:this.model.contentChanged,timeout:1e3}),this._monitor.activityStopped.connect((()=>{this._rendered&&this.update()}),this),this._updateRenderedInput().then((()=>{this._ready.resolve(void 0)})),this.renderInput(this._renderer)}get ready(){return this._ready.promise}get rendered(){return this._rendered}set rendered(t){t!==this._rendered&&(this._rendered=t,this._handleRendered(),this._rendered||this.editor.refresh())}renderInput(t){this.addClass(it),this.inputArea.renderInput(t)}showEditor(){this.removeClass(it),this.inputArea.showEditor()}onUpdateRequest(t){this._handleRendered(),super.onUpdateRequest(t)}updateCellSourceWithAttachment(t,e){var s,n;const a=`![${t}](attachment:${null!=e?e:t})`;null===(n=(s=this.editor).replaceSelection)||void 0===n||n.call(s,a)}_handleRendered(){this._rendered?(this._updateRenderedInput(),this.renderInput(this._renderer)):this.showEditor()}_updateRenderedInput(){const t=this.model,e=t&&t.value.text||"Type Markdown and LaTeX: $ α^2 $";if(e!==this._prevText){const t=new b.MimeModel({data:{"text/markdown":e}});return this._renderer||(this._renderer=this._rendermime.createRenderer("text/markdown"),this._renderer.addClass("jp-MarkdownOutput")),this._prevText=e,this._renderer.renderModel(t)}return Promise.resolve(void 0)}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory,rendermime:this._rendermime})}}class ct extends dt{constructor(t){super(t),this.addClass("jp-RawCell")}clone(){return new(0,this.constructor)({model:this.model,contentFactory:this.contentFactory})}}}}]);
//# sourceMappingURL=5734.bundle.js.map